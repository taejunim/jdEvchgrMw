<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="jdEvchgrMw.chgrInfo.service.impl.ChgrInfoMapper">

	<select id="chgrInfoDataList"  parameterType="ChgrInfoVO" resultType="egovMap">
	
		SELECT MSG_DATA_SEQ
			 , MSG_SEND_TYPE
			 , MSG_ACTION_TYPE
			 , MSG_DATA
			 , DATE_FORMAT(reg_dt, '%Y-%m-%d %H:%i:%s') REG_DT
		
		FROM   tb_msg_data
		
		WHERE  1=1
		AND MSG_ACTION_TYPE = #{msgActionType}
		
		<if test="srtDate != null and !srtDate.equals('')" >
           <![CDATA[ AND REG_DT >= #{srtDate} ]]>
	   </if>      
	   <if test="endDate != null and !endDate.equals('')" >
           <![CDATA[ AND REG_DT <= #{endDate} ]]>
	   </if>  
		<if test="msgSendType != null and !msgSendType.equals('')" >
           <![CDATA[ AND MSG_SEND_TYPE = #{msgSendType} ]]>
	   </if>      
	
		ORDER BY REG_DT DESC
		LIMIT #{pageUnit} OFFSET #{firstIndex}	   
		 
	</select>
	<select id="chgrInfoDataListCnt" resultType="int">
	
		SELECT COUNT(MSG_DATA_SEQ)
		
		FROM   tb_msg_data
		
		WHERE  1=1
		AND MSG_ACTION_TYPE = #{msgActionType}
		
		<if test="srtDate != null and !srtDate.equals('')" >
           <![CDATA[ AND REG_DT >= #{srtDate} ]]>
	   </if>      
	   <if test="endDate != null and !endDate.equals('')" >
           <![CDATA[ AND REG_DT <= #{endDate} ]]>
	   </if>  
		<if test="msgSendType != null and !msgSendType.equals('')" >
           <![CDATA[ AND MSG_SEND_TYPE = #{msgSendType} ]]>
	   </if>    
	   
	
	</select>
	<select id="chgrInfoDataDetail" resultType="egovMap">
	
		SELECT MSG_DATA_SEQ
			 , MSG_SEND_TYPE
			 , MSG_ACTION_TYPE
			 , MSG_DATA
			 , DATE_FORMAT(reg_dt, '%Y-%m-%d %H:%i:%s') REG_DT
		
		FROM   tb_msg_data
		
		WHERE  1=1
		
		AND	  MSG_DATA_SEQ = #{msgDataSeq}
		AND MSG_ACTION_TYPE = #{msgActionType}
	
	</select>

	<insert id="chgrInfoDataInsert" parameterType="chgrInfoVO">
	
		INSERT INTO tb_msg_data (
			MSG_SEND_TYPE
			,MSG_ACTION_TYPE
			,MSG_DATA
			,REG_DT
		)
		VALUES(
			#{msgSendType}
			,#{msgActionType}
			,#{msgData}
			, now()
		)

	</insert>
	
</mapper>